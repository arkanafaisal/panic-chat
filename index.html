<!DOCTYPE html>

<html>
<head>
 <meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">
 <title>Hello, World!</title>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
 <style>
 body{
  background-image: linear-gradient(to bottom, black, red);
  margin: 0;
  padding: 5px;
  height : 100vh;
  width: 100vw;
  color: white;
  font-size: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
 }
 </style>
</head>
<body>
 <a id="link">loading..</a>
 <script>
  const dataUrl = "https://docs.google.com/spreadsheets/d/1GK_p8hqGwqFUj0Yap49wOq8rnUgzwBvIgtwf8tErBFg/export?format=csv" + "&_=" + Date.now()
  let datas, errorMessage
 const link = document.getElementById("link")
 
 async function main(){
  try{
    const response = await fetch(dataUrl)
    datas = await response.text()
    datas = Papa.parse(datas).data
    link.hidden = true
    datas.forEach(data => {
     const newEl = link.cloneNode()
     newEl.textContent = data[0]
     newEl.href = data[1]
     newEl.hidden = false
     document.body.appendChild(newEl)
    })
  } catch{
   link.textContent = 'error'
  }
 }
 main()
  
 
 </script>
  
</body>
</html>
