<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fast Data</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      width: 100vw;
      overflow-x: hidden;
      background: #f4f4f4;
      color: #333;
    }
    header {
      background: #4CAF50;
      color: white;
      padding: 10px 0px;
      margin: 0;
      text-align: center;
    }
    .container {
      width: 80vw;
      max-width: 800px;
      margin: 0 auto;
      padding: 10px;
      border-radius: 5px;
    }
    h1 {
      margin: 0;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: #fafafa;
      border: 1px solid #ddd;
      padding: 10px;
      margin-bottom: 5px;
      border-radius: 3px;
    }
    button {
      display: inline-block;
      padding: 6px 12px;
      background: #4CAF50;
      border: none;
      color: white;
      margin-top: 5px;
      text-decoration: none;
      border-radius: 3px;
      font-size: 14px;
    }
    button:hover {
      background: #45a049;
    }
    h3 {
     width: 100%;
     text-align: center;
    }
  </style>
</head>
<body>
  <header>
    <h1 id="title">Fast Data</h1>
  </header>

  <div class="container">
   
   <h3 id="log">Loading...</h3>
   
    <ul id="list-data">
      <!-- JS will clone and fill <li> items here -->
      <li id="list-node" hidden="true">
        <span>Example link</span><br>
        <button>Copy</button>
      </li>
    </ul>
  </div>
 <script>
 const dataUrl = "https://docs.google.com/spreadsheets/d/1GK_p8hqGwqFUj0Yap49wOq8rnUgzwBvIgtwf8tErBFg/export?format=csv" + "&_=" + Date.now()
 let datas, errorMessage
 const list = document.getElementById("list-data")
 const listNode = document.getElementById("list-node")
 const fragment = document.createDocumentFragment()
 const log = document.getElementById("log")
 
 async function main(){
  try{
    const response = await fetch(dataUrl)
    datas = await response.text()
    datas = Papa.parse(datas).data
    datas.forEach(data => {
     const newEl = listNode.cloneNode(true)
     newEl.children[0].textContent = data[0]
     if(data[1].includes("http")){
      newEl.children[2].textContent = "open"
      newEl.children[2].onclick = ()=>{window.location.href=data[1]}
     } else {
      newEl.children[2].onclick = ()=>{
       navigator.clipboard.writeText(data[1]).then(()=>{alert("copied")}).catch(()=>{alert("failed to copy")})
      }
     }
     newEl.hidden = false
     fragment.appendChild(newEl)
    })
   log.textContent = "Done"
   setTimeout(()=>{list.appendChild(fragment); log.remove()}, 1000)
  } catch{
   log.textContent = 'error'
  }
 }
 main()
 </script>
</body>
</html>